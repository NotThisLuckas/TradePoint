<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TradePoint ‚Äì Trocas de Roube Um Brainrot</title>
  <meta name="description" content="TradePoint: plataforma profissional para trocas do jogo Roube Um Brainrot com an√∫ncios, chat, administra√ß√£o e seguran√ßa." />
  <meta name="theme-color" content="#0b0f1c" />
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <link id="favicon" rel="icon" href="logo.png" />
  <style>
    :root { --bg:#0b0f1c; --panel:#0e1524; --panel2:#111a2b; --text:#eaf2ff; --muted:#98a8bf; --white:#ffffff; --blue:#26d0ff; --vio:#8b5dff; --neon:#21c8ff; --pink:#ff58d9 }
    * { box-sizing: border-box }
    html, body { height:100% }
    body { margin:0; font-family:Poppins, Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background: radial-gradient(1200px 800px at 10% -10%, rgba(38,208,255,0.13), transparent), radial-gradient(800px 500px at 90% -10%, rgba(139,93,255,0.10), transparent), var(--bg); color: var(--text) }
    a { color: inherit; text-decoration: none }
    .header { position: sticky; top:0; z-index:50; background: rgba(11,15,28,0.85); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(38,208,255,0.18) }
    .inner { max-width: 1200px; margin: 0 auto; padding: 14px 20px; display:flex; align-items:center; gap:16px }
    .brand { display:flex; align-items:center; gap:10px }
    .logo { width:120px; height:auto; filter: drop-shadow(0 10px 24px rgba(38,208,255,0.35)) }
    .nav { margin-left:auto; display:flex; gap: 14px; flex-wrap: wrap }
    .nav a { padding:10px 14px; border-radius:999px; color:#cfe7ff; opacity:0.92; transition: transform .25s ease, background .25s ease }
    .nav a:hover { transform: translateY(-2px); background: linear-gradient(90deg, rgba(38,208,255,0.18), rgba(139,93,255,0.18)) }
    .mobile-toggle { display:none; margin-left:auto; appearance:none; border:0; border-radius:12px; padding:10px 12px; font-weight:800; background: linear-gradient(180deg, var(--blue), var(--vio)); color:#051425; box-shadow:0 10px 20px rgba(38,208,255,0.35) }
    .btn { appearance:none; border:0; border-radius:16px; padding:14px 22px; font-weight:800; letter-spacing:0.02em; cursor:pointer; transition: transform .25s ease, box-shadow .25s ease, filter .25s ease }
    .btn-primary { color:#051425; background: linear-gradient(180deg, var(--blue), var(--vio)); box-shadow: 0 16px 30px rgba(38,208,255,0.45), inset 0 0 0 1px rgba(255,255,255,0.2) }
    .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 24px 44px rgba(38,208,255,0.55); filter: brightness(1.08) }
    .btn-secondary { color:#d7e9ff; background: linear-gradient(180deg, #121a2a, #0d1628); box-shadow: 0 12px 22px rgba(0,0,0,0.35); border:1px solid rgba(38,208,255,0.25) }
    .hero { position:relative; overflow:hidden }
    .hero-inner { max-width:1200px; margin:0 auto; padding:80px 20px; display:grid; gap:18px; grid-template-columns: 1.1fr .9fr; align-items:center }
    .hero h1 { margin:0; font-size: clamp(32px, 6vw, 54px); letter-spacing:-0.02em }
    .hero p { margin:0; font-size: clamp(16px, 2.8vw, 20px); color: var(--muted) }
    .mock { width: min(520px, 100%); justify-self: center; border-radius: 24px; background: linear-gradient(135deg, #101a2f, #121d33); box-shadow: 0 30px 80px rgba(38,208,255,0.18); height: 300px; display:grid; place-items:center; color: var(--white); font-weight:800; border: 1px solid rgba(38,208,255,0.25) }
    .section { max-width:1200px; margin:0 auto; padding:64px 20px }
    .section h2 { margin:0 0 14px; font-size: clamp(24px, 4.8vw, 34px) }
    .muted { color: var(--muted) }
    .grid-3 { display:grid; gap:16px; grid-template-columns: repeat(3, minmax(0, 1fr)) }
    .grid-2 { display:grid; gap:16px; grid-template-columns: repeat(2, minmax(0, 1fr)) }
    .grid-4 { display:grid; gap:16px; grid-template-columns: repeat(4, minmax(0, 1fr)) }
    .card { border-radius:18px; background: linear-gradient(180deg, var(--panel), var(--panel2)); box-shadow: 0 18px 60px rgba(0,0,0,0.45); padding:20px; border: 1px solid rgba(38,208,255,0.18) }
    .icon { width:46px; height:46px; border-radius:12px; display:grid; place-items:center; background: radial-gradient(circle at 50% 0%, rgba(38,208,255,0.25), rgba(139,93,255,0.08)); color: var(--white); box-shadow: 0 10px 24px rgba(38,208,255,0.18) }
    input, select, textarea { width:100%; padding:12px 14px; border-radius:14px; border:1px solid rgba(38,208,255,0.25); background:#0e1524; color:#d7e9ff; font-size:14px }
    textarea { min-height: 120px }
    .table-wrap { overflow:auto }
    .table { width:100%; border-collapse: collapse }
    .table th, .table td { border-bottom: 1px solid rgba(38,208,255,0.18); padding:8px }
    .footer { border-top: 1px solid rgba(38,208,255,0.18); background: #0b111f; margin-top:40px }
    .footer-inner { max-width:1200px; margin:0 auto; padding:24px 20px; display:grid; gap:16px; grid-template-columns: 1.2fr .8fr; align-items:center }
    .footer-links { display:flex; gap:12px; flex-wrap: wrap; justify-content:flex-end }
    .scroll-x { overflow-x:auto; white-space:nowrap }
    .chip { display:inline-flex; align-items:center; gap:6px; border:1px solid rgba(38,208,255,0.25); border-radius:14px; padding:6px 10px; background:#0e1524 }
    .reveal { opacity:0; transform:translateY(12px); transition: opacity .45s ease, transform .45s ease }
    .reveal.on { opacity:1; transform:translateY(0) }
    section, .hero { scroll-margin-top: 80px }
    @media (max-width: 900px) { .hero-inner { grid-template-columns:1fr; text-align:center } .mobile-toggle { display:inline-flex } .nav { position: fixed; top:0; right:0; width:74vw; max-width:340px; height:100dvh; background:#0b111f; box-shadow: -16px 0 40px rgba(0,0,0,0.35); display:flex; flex-direction:column; padding:18px; gap:10px; transform: translateX(100%); transition: transform .3s ease; z-index:60 } .nav.open { transform: translateX(0); display:flex } }
    @media (max-width: 700px) { .grid-3, .grid-2, .grid-4 { grid-template-columns:1fr } .btn { padding:12px 18px } input, select, textarea { font-size:16px } .mock { width: 100%; height: 240px } }
    @media (prefers-reduced-motion: reduce) { * { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; scroll-behavior: auto !important } }
  </style>
</head>
<body>
  <header class="header">
    <div class="inner">
      <div class="brand"><img class="logo" src="logo.png" alt="TradePoint" /><strong>TradePoint</strong></div>
      <button id="menuBtn" class="mobile-toggle" aria-label="Abrir menu">Menu</button>
      <nav class="nav" id="navMain">
        <a href="#inicio">Home</a>
        <a href="#explorar">Explorar Trocas</a>
        <a href="#criar">Criar An√∫ncio</a>
        <a href="#chat">Chat</a>
        <a href="#perfil">Perfil</a>
        <a href="#adm">Painel ADM</a>
        <a href="#conta">Login</a>
        <a href="#conta" class="btn btn-primary">Cadastro</a>
      </nav>
    </div>
  </header>

  <section id="inicio" class="hero">
    <div class="hero-inner">
      <div class="reveal"><h1>TradePoint ‚Äî Trocas seguras de Roube Um Brainrot</h1><p>Crie an√∫ncios tempor√°rios, converse no chat, chame ADM e finalize trocas com avalia√ß√µes.</p><div style="margin-top:18px; display:flex; gap:12px; flex-wrap:wrap; align-items:center"><a href="#criar" class="btn btn-primary">Criar an√∫ncio</a><a href="#explorar" class="btn btn-secondary">Explorar Trocas</a></div></div>
      <div class="mock reveal">Vitrine de Trocas</div>
    </div>
  </section>

  <section id="explorar" class="section reveal" style="display:none">
    <h2>Vitrine de Trocas</h2>
    <div class="card" style="display:grid; gap:10px"><div style="display:flex; flex-wrap:wrap; gap:10px"><input id="fText" placeholder="Buscar" /><input id="fBrain" placeholder="Nome do brainrot" /><select id="fRarity"><option value="">Raridade</option><option>Comum</option><option>Raro</option><option>Lend√°rio</option></select><input id="fUser" placeholder="Usu√°rio" /><input id="fDate" type="date" /><button id="fApply" class="btn btn-secondary">Filtrar</button></div><div id="listPosts" class="grid-3"></div><div style="display:flex; gap:10px; margin-top:10px"><button id="pgPrev" class="btn btn-secondary">Anterior</button><button id="pgNext" class="btn btn-secondary">Pr√≥ximo</button><span class="muted" id="pgInfo"></span></div></div>
    <h3 style="margin-top:24px">Avalia√ß√µes Recentes</h3>
    <div class="card scroll-x" id="recentReviews" style="padding:10px; white-space:nowrap"></div>
  </section>

  <section id="criar" class="section reveal" style="display:none">
    <h2>Criar An√∫ncio</h2>
    <div class="grid-2"><div class="card"><h3>Dados</h3><div style="display:grid; gap:10px"><input id="pImage" placeholder="Foto (URL)" /><input id="pName" placeholder="Nome do brainrot" /><select id="pRarity"><option>Comum</option><option>Raro</option><option>Lend√°rio</option></select><input id="pHave" placeholder="Item que possui" /><input id="pWant" placeholder="Item que procura" /><textarea id="pDesc" placeholder="Descri√ß√£o (opcional)"></textarea><div class="muted">Expira em: <span id="pExpire">24h</span></div><button id="pCreate" class="btn btn-primary">Publicar</button></div></div><div class="card"><h3>Regras</h3><div class="muted">An√∫ncios expiram em 24 horas e devem ser repostados. Use imagens reais e descreva claramente sua oferta e procura.</div></div></div>
  </section>

  <section id="chat" class="section reveal" style="display:none">
    <h2>Chats</h2>
    <div class="grid-2"><div class="card"><h3>Conversas abertas</h3><ul id="chatList" style="margin:0; padding-left:20px"></ul></div><div class="card"><h3>Sala</h3><div id="chatBox" style="height:44vh; overflow:auto; display:flex; flex-direction:column; gap:8px; padding:10px; background:#0e1524; border:1px solid rgba(38,208,255,0.18); border-radius:12px"></div><div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap"><input id="chatText" placeholder="Mensagem" /><input id="chatImg" placeholder="Imagem (URL)" /><button id="chatSend" class="btn btn-primary">Enviar</button><button id="chatAdm" class="btn btn-secondary">Chamar ADM</button></div></div></div>
  </section>

  <section id="perfil" class="section reveal" style="display:none">
    <h2>Perfil do Usu√°rio</h2>
    <div class="grid-2"><div class="card"><h3>Informa√ß√µes</h3><div style="display:grid; gap:10px"><img class="logo" src="logo.png" alt="TradePoint" style="width:120px" /><input id="uPhoto" placeholder="Foto (URL)" /><input id="uName" placeholder="Nome" /><input id="uRoblox" placeholder="ID Roblox (opcional)" /><div class="muted">Reputa√ß√£o: <span id="uRep">0</span></div><button id="uSave" class="btn btn-secondary">Salvar Perfil</button></div></div><div class="card"><h3>Hist√≥rico</h3><div class="table-wrap"><table class="table" id="tHistory"><thead><tr><th>Brainrot</th><th>Status</th><th>Data</th></tr></thead><tbody></tbody></table></div><h3 style="margin-top:14px">Avalia√ß√µes</h3><div class="table-wrap"><table class="table" id="tReviews"><thead><tr><th>Avaliador</th><th>Brainrot</th><th>Tipo</th><th>Data</th></tr></thead><tbody></tbody></table></div></div></div>
  </section>

  <section id="adm" class="section reveal" style="display:none">
    <h2>Painel ADM</h2>
    <div id="admLogin" class="card"><div style="display:grid; gap:10px"><img class="logo" src="logo.png" alt="TradePoint" style="width:120px" /><input id="adUser" placeholder="Usu√°rio" /><input id="adPass" type="password" placeholder="Senha" /><button id="adDo" class="btn btn-primary">Entrar</button></div></div>
    <div id="admPanel" style="display:none">
      <div class="grid-3"><div class="card"><h3>Usu√°rios</h3><div class="table-wrap"><table class="table" id="tUsers"><thead><tr><th>Nome</th><th>Email</th><th>Rep</th><th>Role</th><th>Status</th><th>A√ß√µes</th></tr></thead><tbody></tbody></table></div></div><div class="card"><h3>An√∫ncios</h3><div class="table-wrap"><table class="table" id="tPosts"><thead><tr><th>Brainrot</th><th>Raridade</th><th>Usu√°rio</th><th>Status</th><th>Criado</th><th>A√ß√µes</th></tr></thead><tbody></tbody></table></div></div><div class="card"><h3>Chamados</h3><div class="table-wrap"><table class="table" id="tCases"><thead><tr><th>ID</th><th>Chat</th><th>Usu√°rios</th><th>Status</th><th>A√ß√µes</th></tr></thead><tbody></tbody></table></div></div><div class="card"><h3>Avisos globais</h3><div style="display:flex; gap:10px"><input id="avText" placeholder="Texto" /><button id="avSet" class="btn btn-secondary">Publicar</button></div><div id="avBox" style="margin-top:8px" class="muted"></div></div><div class="card"><h3>Logs</h3><div class="table-wrap"><table class="table" id="tLogs"><thead><tr><th>Quando</th><th>Quem</th><th>A√ß√£o</th><th>Detalhes</th></tr></thead><tbody></tbody></table></div></div></div>
    </div>
  </section>

  <section id="conta" class="section reveal" style="display:none">
    <h2>Conta</h2>
    <div class="grid-2"><div class="card"><h3>Cadastro</h3><div style="display:grid; gap:10px"><img class="logo" src="logo.png" alt="TradePoint" style="width:120px" /><input id="cEmail" placeholder="Email" /><input id="cPass" type="password" placeholder="Senha" /><input id="cName" placeholder="Nome" /><button id="cDo" class="btn btn-primary">Cadastrar</button></div></div><div class="card"><h3>Login</h3><div style="display:grid; gap:10px"><img class="logo" src="logo.png" alt="TradePoint" style="width:120px" /><input id="lEmail" placeholder="Email" /><input id="lPass" type="password" placeholder="Senha" /><button id="lDo" class="btn btn-secondary">Entrar</button><input id="resetEmail" placeholder="Email para redefinir senha" /><button id="resetDo" class="btn btn-secondary">Redefinir senha</button></div></div></div>
  </section>

  <footer class="footer"><div class="footer-inner"><div class="brand"><img class="logo" src="logo.png" alt="TradePoint" style="width:120px" /></div><div class="footer-links"><a href="#">Explica√ß√£o do site</a><a href="#explorar">Explorar</a><a href="#criar">Criar an√∫ncio</a><a href="#chat">Chat</a><a href="#perfil">Perfil</a><a href="#adm">Painel ADM</a></div></div></footer>

  <div id="overlay" class="overlay" style="position:fixed; inset:0; background:rgba(0,0,0,0.35); backdrop-filter: blur(2px); opacity:0; pointer-events:none; transition:opacity .3s ease"></div>
  <script>
    const K_USERS='tp_users', K_SESS='tp_session', K_POSTS='tp_posts', K_CHATS='tp_chats', K_CASES='tp_cases', K_LOGS='tp_logs', K_REVIEWS='tp_reviews', K_AV='tp_notices', K_LOGO='tp_logo_url'
    const DEFAULT_LOGO_URL='https://chatgpt.com/s/m_692e020a7b44819186d6d7f77cff9a3c'
    const FALLBACK_SVG='data:image/svg+xml;utf8,'+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 256 256"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#26d0ff"/><stop offset="1" stop-color="#8b5dff"/></linearGradient></defs><rect width="256" height="256" rx="24" fill="#0b0f1c"/><path d="M70 70 L70 186 L186 128 Z" fill="url(#g)"/><text x="128" y="230" font-size="42" fill="#eaf2ff" text-anchor="middle" font-family="Poppins">TradePoint</text></svg>')
    function logoUrl(){ return localStorage.getItem(K_LOGO) || DEFAULT_LOGO_URL }
    function applyLogo(){ const url=logoUrl(); document.querySelectorAll('img.logo').forEach(el=>{ el.onerror=()=>{ el.src=FALLBACK_SVG }; el.src=url; }); const fav=document.getElementById('favicon'); if(fav) fav.href=url }
    function seed(){ if(!localStorage.getItem(K_USERS)){ localStorage.setItem(K_USERS, JSON.stringify([{id:'admin', email:'admin@tp', pass:'TradePoint#2025', name:'Admin', role:'admin', photo:'', rep:0, verified:true, muted:false, banned:false, roblox:''}])) } if(!localStorage.getItem(K_POSTS)){ localStorage.setItem(K_POSTS, JSON.stringify([])) } if(!localStorage.getItem(K_CHATS)){ localStorage.setItem(K_CHATS, JSON.stringify([])) } if(!localStorage.getItem(K_CASES)){ localStorage.setItem(K_CASES, JSON.stringify([])) } if(!localStorage.getItem(K_LOGS)){ localStorage.setItem(K_LOGS, JSON.stringify([])) } if(!localStorage.getItem(K_REVIEWS)){ localStorage.setItem(K_REVIEWS, JSON.stringify([])) } if(!localStorage.getItem(K_AV)){ localStorage.setItem(K_AV, '') } }
    function getUsers(){ try{return JSON.parse(localStorage.getItem(K_USERS)||'[]')}catch{return[]} }
    function setUsers(v){ localStorage.setItem(K_USERS, JSON.stringify(v)) }
    function getPosts(){ try{return JSON.parse(localStorage.getItem(K_POSTS)||'[]')}catch{return[]} }
    function setPosts(v){ localStorage.setItem(K_POSTS, JSON.stringify(v)) }
    function getChats(){ try{return JSON.parse(localStorage.getItem(K_CHATS)||'[]')}catch{return[]} }
    function setChats(v){ localStorage.setItem(K_CHATS, JSON.stringify(v)) }
    function getCases(){ try{return JSON.parse(localStorage.getItem(K_CASES)||'[]')}catch{return[]} }
    function setCases(v){ localStorage.setItem(K_CASES, JSON.stringify(v)) }
    function getLogs(){ try{return JSON.parse(localStorage.getItem(K_LOGS)||'[]')}catch{return[]} }
    function setLogs(v){ localStorage.setItem(K_LOGS, JSON.stringify(v)) }
    function getReviews(){ try{return JSON.parse(localStorage.getItem(K_REVIEWS)||'[]')}catch{return[]} }
    function setReviews(v){ localStorage.setItem(K_REVIEWS, JSON.stringify(v)) }
    function getNotice(){ return localStorage.getItem(K_AV)||'' }
    function setNotice(v){ localStorage.setItem(K_AV, v) }
    function getSession(){ try{return JSON.parse(localStorage.getItem(K_SESS)||'null')}catch{return null} }
    function setSession(v){ localStorage.setItem(K_SESS, JSON.stringify(v)) }
    function me(){ const s=getSession(); if(!s) return null; return getUsers().find(u=>u.id===s.id) }
    function uid(){ return Math.random().toString(36).slice(2) + Date.now().toString(36) }
    function now(){ return new Date().toISOString() }
    function canAct(key,ms){ const k='tp_th_'+key; const last=parseInt(localStorage.getItem(k)||'0',10); const t=Date.now(); if(t-last<ms) return false; localStorage.setItem(k,String(t)); return true }
    function route(){ const h=window.location.hash||''; const ids=['inicio','explorar','criar','chat','perfil','adm','conta']; ids.forEach(id=>{ const el=document.getElementById(id); if(!el) return; const show=('#'+id===h)|| (h===''&&id==='inicio'); el.style.display= show ? 'block' : 'none' }); if(h==='#explorar'){ renderExplore(); renderRecentReviews() } if(h==='#chat'){ renderChatList() } if(h==='#perfil'){ renderProfile() } if(h==='#adm'){ document.getElementById('admLogin').style.display='block'; document.getElementById('admPanel').style.display='none'; renderAdminTables() } }
    function expireSweep(){ const posts=getPosts(); const t=Date.now(); let ch=false; for(const p of posts){ if(p.status==='active' && t>=new Date(p.expiresAt).getTime()){ p.status='expired'; ch=true } } if(ch) setPosts(posts) }
    function renderExplore(){ expireSweep(); const posts=getPosts().filter(p=>p.status!=='removed'); const q=(document.getElementById('fText').value||'').toLowerCase(); const b=(document.getElementById('fBrain').value||'').toLowerCase(); const r=(document.getElementById('fRarity').value||''); const u=(document.getElementById('fUser').value||'').toLowerCase(); const d=(document.getElementById('fDate').value||''); let list=posts.filter(p=> (!q || (p.name.toLowerCase().includes(q)||p.desc.toLowerCase().includes(q)||p.have.toLowerCase().includes(q)||p.want.toLowerCase().includes(q))) && (!b || p.name.toLowerCase().includes(b)) && (!r || p.rarity===r) && (!u || (getUsers().find(x=>x.id===p.userId)?.name||'').toLowerCase().includes(u)) && (!d || p.createdAt.slice(0,10)===d) ); const pageSize=6; const page=parseInt(localStorage.getItem('tp_page')||'1',10); const pages=Math.max(1, Math.ceil(list.length/pageSize)); const cur=Math.min(page,pages); localStorage.setItem('tp_page',String(cur)); const slice=list.slice((cur-1)*pageSize, cur*pageSize); const box=document.getElementById('listPosts'); box.innerHTML=''; for(const p of slice){ const u=getUsers().find(x=>x.id===p.userId); const card=document.createElement('div'); card.className='card'; card.innerHTML=`<div style='display:grid; gap:8px'><img src='${p.image||''}' alt='brainrot' style='width:100%; height:160px; object-fit:cover; border-radius:12px' onerror="this.style.display='none'"/><div style='display:flex; gap:8px; flex-wrap:wrap'><span class='chip'>${p.name}</span><span class='chip'>${p.rarity}</span><span class='chip'>${u?u.name:'?'}</span><span class='chip'>${p.status==='expired'?'Expirado':'Ativo'}</span></div><div class='muted'>Possui: ${p.have} ¬∑ Procura: ${p.want}</div><div style='display:flex; gap:10px; flex-wrap:wrap'><button class='btn btn-primary' data-id='${p.id}' data-act='contact'>Entrar em contato</button></div></div>`; box.appendChild(card) } document.getElementById('pgInfo').textContent=`P√°gina ${cur}/${pages}`; box.querySelectorAll('button[data-act=contact]').forEach(b=>b.addEventListener('click',(e)=>{ const id=e.currentTarget.getAttribute('data-id'); openChatForPost(id) })) }
    function renderRecentReviews(){ const list=getReviews().slice(-12).reverse(); const box=document.getElementById('recentReviews'); box.innerHTML=''; for(const r of list){ const u=getUsers().find(x=>x.id===r.by); const div=document.createElement('div'); div.className='chip'; div.style.marginRight='8px'; div.innerHTML=`<span>${u?u.name:'?'}</span><span>${r.brain}</span><span>${r.type==='pos'?'üëç Positiva':'üëé Negativa'}</span><span>${new Date(r.date).toLocaleDateString()}</span>`; box.appendChild(div) } }
    function openChatForPost(postId){ const u=me(); if(!u){ alert('Entre na conta primeiro'); window.location.hash='#conta'; return } const posts=getPosts(); const p=posts.find(x=>x.id===postId); if(!p){ alert('An√∫ncio n√£o encontrado'); return } let chats=getChats(); let chat=chats.find(c=>c.postId===postId && ((c.aId===u.id)||(c.bId===u.id))); if(!chat){ chat={id:uid(), postId, aId:p.userId, bId:u.id, msgs:[], caseId:null, status:'open'}; chats.push(chat); setChats(chats) } window.location.hash='#chat'; renderChatList(); selectChat(chat.id) }
    function renderChatList(){ const u=me(); const list=document.getElementById('chatList'); list.innerHTML=''; const chats=getChats().filter(c=> c.aId===u?.id || c.bId===u?.id ); for(const c of chats){ const p=getPosts().find(x=>x.id===c.postId); const li=document.createElement('li'); li.innerHTML=`<a href='#' data-id='${c.id}' class='chatSel'>${p?p.name:'(apagado)'} ‚Äî ${c.status}</a>`; list.appendChild(li) } list.querySelectorAll('.chatSel').forEach(a=>a.addEventListener('click',(e)=>{ e.preventDefault(); selectChat(e.currentTarget.getAttribute('data-id')) })) }
    function selectChat(id){ localStorage.setItem('tp_chat',id); const box=document.getElementById('chatBox'); box.innerHTML=''; const chat=getChats().find(c=>c.id===id); if(!chat) return; for(const m of chat.msgs){ const d=document.createElement('div'); d.style.borderRadius='12px'; d.style.padding='8px 10px'; d.style.maxWidth='80%'; d.style.background= m.from===me()?.id ? '#162235' : '#0f1a2b'; d.style.alignSelf= m.from===me()?.id ? 'flex-end' : 'flex-start'; d.textContent= m.type==='text' ? m.content : ''; if(m.type==='img'){ const img=document.createElement('img'); img.src=m.content; img.style.maxWidth='80%'; img.style.borderRadius='12px'; d.textContent=''; d.appendChild(img) } box.appendChild(d) } box.scrollTop=box.scrollHeight }
    function sendMsg(){ const id=localStorage.getItem('tp_chat'); const chats=getChats(); const i=chats.findIndex(c=>c.id===id); if(i<0){ alert('Selecione um chat'); return } const txt=document.getElementById('chatText').value.trim(); const img=document.getElementById('chatImg').value.trim(); if(!txt && !img){ alert('Escreva ou informe uma imagem'); return } if(!canAct('msg',500)) return; chats[i].msgs.push({from:me().id, type: img ? 'img':'text', content: img||txt, time: now()}); setChats(chats); document.getElementById('chatText').value=''; document.getElementById('chatImg').value=''; selectChat(id) }
    function callAdm(){ const id=localStorage.getItem('tp_chat'); const chats=getChats(); const chat=chats.find(c=>c.id===id); if(!chat){ alert('Selecione um chat'); return } if(chat.caseId){ alert('J√° encaminhado ao ADM'); return } const caseId=uid(); chat.caseId=caseId; setChats(chats); const cases=getCases(); cases.push({id:caseId, chatId:id, postId:chat.postId, aId:chat.aId, bId:chat.bId, status:'open', actions:[], createdAt:now()}); setCases(cases); const logs=getLogs(); logs.push({time:now(), who:me().id, act:'chamar_adm', detail:id}); setLogs(logs); alert('ADM notificado') }
    function reviewUser(targetId, postId, brain, type){ const revs=getReviews(); revs.push({id:uid(), user:targetId, by:me().id, postId, brain, type, date:now()}); setReviews(revs); const users=getUsers(); const i=users.findIndex(u=>u.id===targetId); if(i>-1){ users[i].rep += (type==='pos'?1:-1); setUsers(users) } }
    function renderProfile(){ const u=me(); if(!u){ window.location.hash='#conta'; return } document.getElementById('uName').value=u.name||''; document.getElementById('uPhoto').value=u.photo||''; document.getElementById('uRoblox').value=u.roblox||''; document.getElementById('uRep').textContent=u.rep||0; const posts=getPosts().filter(p=>p.userId===u.id); const tbody=document.querySelector('#tHistory tbody'); tbody.innerHTML=''; for(const p of posts){ const tr=document.createElement('tr'); tr.innerHTML=`<td>${p.name}</td><td>${p.status}</td><td>${new Date(p.createdAt).toLocaleString()}</td>`; tbody.appendChild(tr) } const revs=getReviews().filter(r=>r.user===u.id); const tbodyR=document.querySelector('#tReviews tbody'); tbodyR.innerHTML=''; for(const r of revs){ const by=getUsers().find(x=>x.id===r.by); const tr=document.createElement('tr'); tr.innerHTML=`<td>${by?by.name:'?'}</td><td>${r.brain}</td><td>${r.type==='pos'?'üëç':'üëé'}</td><td>${new Date(r.date).toLocaleString()}</td>`; tbodyR.appendChild(tr) } }
    function saveProfile(){ const u=me(); if(!u){ return } const users=getUsers(); const i=users.findIndex(x=>x.id===u.id); users[i].name=document.getElementById('uName').value; users[i].photo=document.getElementById('uPhoto').value; users[i].roblox=document.getElementById('uRoblox').value; setUsers(users); renderProfile(); alert('Perfil salvo') }
    function createPost(){ const u=me(); if(!u){ alert('Entre na conta primeiro'); window.location.hash='#conta'; return } const image=document.getElementById('pImage').value.trim(); const name=document.getElementById('pName').value.trim(); const rarity=document.getElementById('pRarity').value; const have=document.getElementById('pHave').value.trim(); const want=document.getElementById('pWant').value.trim(); const desc=document.getElementById('pDesc').value.trim(); if(!name||!have||!want){ alert('Preencha os campos obrigat√≥rios'); return } const createdAt=now(); const expiresAt=new Date(Date.now()+24*3600*1000).toISOString(); const posts=getPosts(); posts.push({id:uid(), userId:u.id, image, name, rarity, have, want, desc, createdAt, expiresAt, status:'active'}); setPosts(posts); alert('Publicado'); window.location.hash='#explorar'; renderExplore() }
    function renderAdminTables(){ const users=getUsers(); const tbody=document.querySelector('#tUsers tbody'); if(!tbody) return; tbody.innerHTML=''; for(const u of users){ const st=(u.banned?'Banido':(u.muted?'Mutado':'OK')); const tr=document.createElement('tr'); tr.innerHTML=`<td>${u.name}</td><td>${u.email||''}</td><td>${u.rep||0}</td><td>${u.role||'user'}</td><td>${st}</td><td><button data-id='${u.id}' data-act='ban'>Banir/Desbanir</button><button data-id='${u.id}' data-act='mute'>Mutar/Desmutar</button></td>`; tbody.appendChild(tr) } const posts=getPosts(); const tbodyP=document.querySelector('#tPosts tbody'); tbodyP.innerHTML=''; for(const p of posts){ const u=users.find(x=>x.id===p.userId); const tr=document.createElement('tr'); tr.innerHTML=`<td>${p.name}</td><td>${p.rarity}</td><td>${u?u.name:'?'}</td><td>${p.status}</td><td>${new Date(p.createdAt).toLocaleString()}</td><td><button data-id='${p.id}' data-act='remove'>Remover</button><button data-id='${p.id}' data-act='confirm'>Confirmar troca</button></td>`; tbodyP.appendChild(tr) } const cases=getCases(); const tbodyC=document.querySelector('#tCases tbody'); tbodyC.innerHTML=''; for(const c of cases){ const uA=users.find(x=>x.id===c.aId), uB=users.find(x=>x.id===c.bId); const tr=document.createElement('tr'); tr.innerHTML=`<td>${c.id.slice(-6)}</td><td>${c.chatId.slice(-6)}</td><td>${uA?uA.name:'?'} ¬∑ ${uB?uB.name:'?'}</td><td>${c.status}</td><td><button data-id='${c.id}' data-act='close'>Encerrar</button><button data-id='${c.id}' data-act='sus'>Sinalizar suspeito</button></td>`; tbodyC.appendChild(tr) } const tbodyL=document.querySelector('#tLogs tbody'); tbodyL.innerHTML=''; const logs=getLogs().slice(-40).reverse(); for(const l of logs){ const u=users.find(x=>x.id===l.who); const tr=document.createElement('tr'); tr.innerHTML=`<td>${new Date(l.time).toLocaleString()}</td><td>${u?u.name:'?'}</td><td>${l.act}</td><td>${l.detail||''}</td>`; tbodyL.appendChild(tr) } document.getElementById('avBox').textContent=getNotice(); const panel=document.getElementById('admPanel'); if(panel) panel.querySelectorAll('button').forEach(b=>b.addEventListener('click',onAdminAction)) }
    function onAdminAction(e){ const id=e.currentTarget.getAttribute('data-id'); const act=e.currentTarget.getAttribute('data-act'); const users=getUsers(); const posts=getPosts(); const cases=getCases(); const logs=getLogs(); if(act==='ban'){ const i=users.findIndex(u=>u.id===id); if(i>-1){ users[i].banned=!users[i].banned; setUsers(users); logs.push({time:now(), who:me()?.id||'admin', act:users[i].banned?'ban':'unban', detail:id}); setLogs(logs) } } else if(act==='mute'){ const i=users.findIndex(u=>u.id===id); if(i>-1){ users[i].muted=!users[i].muted; setUsers(users); logs.push({time:now(), who:me()?.id||'admin', act:users[i].muted?'mute':'unmute', detail:id}); setLogs(logs) } } else if(act==='remove'){ const i=posts.findIndex(p=>p.id===id); if(i>-1){ posts[i].status='removed'; setPosts(posts); logs.push({time:now(), who:me()?.id||'admin', act:'remove_post', detail:id}); setLogs(logs) } } else if(act==='confirm'){ const p=posts.find(x=>x.id===id); if(p){ const revs=getReviews(); revs.push({id:uid(), user:p.userId, by:me()?.id||'admin', postId:id, brain:p.name, type:'pos', date:now()}); setReviews(revs); logs.push({time:now(), who:me()?.id||'admin', act:'confirm_trade', detail:id}); setLogs(logs) } } else if(act==='close'){ const i=cases.findIndex(c=>c.id===id); if(i>-1){ cases[i].status='closed'; setCases(cases); logs.push({time:now(), who:me()?.id||'admin', act:'close_case', detail:id}); setLogs(logs) } } else if(act==='sus'){ const i=cases.findIndex(c=>c.id===id); if(i>-1){ logs.push({time:now(), who:me()?.id||'admin', act:'flag_suspect', detail:id}); setLogs(logs) } } renderAdminTables() }
    function verify(email){ return /.+@.+\..+/.test(email||'') }
    function register(){ const email=document.getElementById('cEmail').value.trim(); const pass=document.getElementById('cPass').value.trim(); const name=document.getElementById('cName').value.trim(); if(!verify(email)||pass.length<4||!name){ alert('Dados inv√°lidos'); return } const users=getUsers(); if(users.find(u=>u.email===email)){ alert('Email j√° cadastrado'); return } const id=uid(); users.push({id,email,pass,name,role:'user',photo:'',rep:0,verified:false,muted:false,banned:false,roblox:''}); setUsers(users); setSession({id}); alert('Conta criada'); window.location.hash='#perfil'; renderProfile() }
    function login(){ const email=document.getElementById('lEmail').value.trim(); const pass=document.getElementById('lPass').value.trim(); const u=getUsers().find(u=>u.email===email&&u.pass===pass); if(!u){ alert('Credenciais inv√°lidas'); return } if(u.banned){ alert('Conta banida'); return } setSession({id:u.id}); alert('Login realizado'); window.location.hash='#explorar'; renderExplore() }
    function reset(){ const email=document.getElementById('resetEmail').value.trim(); const u=getUsers().find(x=>x.email===email); alert(u?'Link de redefini√ß√£o enviado (demo)':'Email n√£o encontrado') }
    function admLogin(){ const user=document.getElementById('adUser').value; const pass=document.getElementById('adPass').value; const u=getUsers().find(x=>x.role==='admin' && (x.email===user||x.name===user) && x.pass===pass); if(!u){ alert('Credenciais inv√°lidas'); return } setSession({id:u.id}); document.getElementById('admLogin').style.display='none'; document.getElementById('admPanel').style.display='block'; renderAdminTables() }
    function setNoticeUI(){ const v=document.getElementById('avText').value; setNotice(v); document.getElementById('avBox').textContent=v; alert('Aviso publicado') }
    function goAnywhere(url){ if(!url) return; window.location.href=url }
    const revealEls=document.querySelectorAll('.reveal'); const io=new IntersectionObserver((entries)=>{entries.forEach(e=>{if(e.isIntersecting){e.target.classList.add('on');io.unobserve(e.target);}})},{threshold:0.25}); revealEls.forEach(el=>io.observe(el)); const menuBtn=document.getElementById('menuBtn'); const nav=document.getElementById('navMain'); const overlay=document.getElementById('overlay'); function toggleMenu(){ const open=!nav.classList.contains('open'); nav.classList.toggle('open',open); overlay.style.opacity=open?'1':'0'; overlay.style.pointerEvents=open?'auto':'none' } menuBtn.addEventListener('click',toggleMenu); overlay.addEventListener('click',toggleMenu); nav.querySelectorAll('a').forEach(a=>a.addEventListener('click',()=>{ if(nav.classList.contains('open')) toggleMenu() }));
    seed(); applyLogo(); route(); window.addEventListener('hashchange',route); document.getElementById('fApply').addEventListener('click',renderExplore); document.getElementById('pgPrev').addEventListener('click',()=>{ const n=Math.max(1,parseInt(localStorage.getItem('tp_page')||'1',10)-1); localStorage.setItem('tp_page',String(n)); renderExplore() }); document.getElementById('pgNext').addEventListener('click',()=>{ const n=parseInt(localStorage.getItem('tp_page')||'1',10)+1; localStorage.setItem('tp_page',String(n)); renderExplore() }); document.getElementById('pCreate').addEventListener('click',createPost); document.getElementById('chatSend').addEventListener('click',sendMsg); document.getElementById('chatAdm').addEventListener('click',callAdm); document.getElementById('uSave').addEventListener('click',saveProfile); document.getElementById('cDo').addEventListener('click',register); document.getElementById('lDo').addEventListener('click',login); document.getElementById('resetDo').addEventListener('click',reset); document.getElementById('adDo').addEventListener('click',admLogin); document.getElementById('avSet').addEventListener('click',setNoticeUI)
  </script>
</body>
</html>
